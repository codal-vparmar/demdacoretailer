{"version":3,"sources":["webpack:///./assets/js/theme/product/reviews.js","webpack:///./assets/js/theme/product/video-gallery.js","webpack:///./assets/js/theme/product.js"],"names":["$reviewForm","this","validator","submit","find","$reviewsContent","$","$collapsible","initLinkBind","injectPaginationLink","collapseReviews","$content","on","trigger","hasClass","click","window","location","hash","indexOf","$nextLink","$prevLink","length","attr","context","add","selector","validate","errorMessage","reviewRating","reviewSubject","reviewComment","cb","val","email","reviewEmail","performCheck","VideoGallery","$element","$player","$videos","currentVideo","bindEvents","e","preventDefault","$target","currentTarget","id","data","$selectedThumb","setMainVideo","setActiveThumb","removeClass","addClass","selectNewVideo","bind","videoGallery","each","index","element","$el","Product","super","url","href","$reviewLink","$bulkPricingLink","document","history","replaceState","title","pathname","productDetails","BCData","product_attributes","setProductVariant","review","registerValidation","areAll","productReviewHandler","bulkPricingHandler"],"mappings":"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","file":"theme-bundle.chunk.2.js","sourcesContent":["import nod from '../common/nod';\r\nimport { CollapsibleEvents } from '../common/collapsible';\r\nimport forms from '../common/models/forms';\r\n\r\nexport default class {\r\n    constructor($reviewForm) {\r\n        this.validator = nod({\r\n            submit: $reviewForm.find('input[type=\"submit\"]'),\r\n        });\r\n\r\n        this.$reviewsContent = $('#product-reviews');\r\n        this.$collapsible = $('[data-collapsible]', this.$reviewsContent);\r\n\r\n        this.initLinkBind();\r\n        this.injectPaginationLink();\r\n        this.collapseReviews();\r\n    }\r\n\r\n    /**\r\n     * On initial page load, the user clicks on \"(12 Reviews)\" link\r\n     * The browser jumps to the review page and should expand the reviews section\r\n     */\r\n    initLinkBind() {\r\n        const $content = $('#productReviews-content', this.$reviewsContent);\r\n\r\n        $('.productView-reviewLink').on('click', () => {\r\n            $('.productView-reviewTabLink').trigger('click');\r\n            if (!$content.hasClass('is-open')) {\r\n                this.$collapsible.trigger(CollapsibleEvents.click);\r\n            }\r\n        });\r\n    }\r\n\r\n    collapseReviews() {\r\n        // We're in paginating state, do not collapse\r\n        if (window.location.hash && window.location.hash.indexOf('#product-reviews') === 0) {\r\n            return;\r\n        }\r\n\r\n        // force collapse on page load\r\n        this.$collapsible.trigger(CollapsibleEvents.click);\r\n    }\r\n\r\n    /**\r\n     * Inject ID into the pagination link\r\n     */\r\n    injectPaginationLink() {\r\n        const $nextLink = $('.pagination-item--next .pagination-link', this.$reviewsContent);\r\n        const $prevLink = $('.pagination-item--previous .pagination-link', this.$reviewsContent);\r\n\r\n        if ($nextLink.length) {\r\n            $nextLink.attr('href', `${$nextLink.attr('href')} #product-reviews`);\r\n        }\r\n\r\n        if ($prevLink.length) {\r\n            $prevLink.attr('href', `${$prevLink.attr('href')} #product-reviews`);\r\n        }\r\n    }\r\n\r\n    registerValidation(context) {\r\n        this.context = context;\r\n        this.validator.add([{\r\n            selector: '[name=\"revrating\"]',\r\n            validate: 'presence',\r\n            errorMessage: this.context.reviewRating,\r\n        }, {\r\n            selector: '[name=\"revtitle\"]',\r\n            validate: 'presence',\r\n            errorMessage: this.context.reviewSubject,\r\n        }, {\r\n            selector: '[name=\"revtext\"]',\r\n            validate: 'presence',\r\n            errorMessage: this.context.reviewComment,\r\n        }, {\r\n            selector: '.writeReview-form [name=\"email\"]',\r\n            validate: (cb, val) => {\r\n                const result = forms.email(val);\r\n                cb(result);\r\n            },\r\n            errorMessage: this.context.reviewEmail,\r\n        }]);\r\n\r\n        return this.validator;\r\n    }\r\n\r\n    validate() {\r\n        return this.validator.performCheck();\r\n    }\r\n}\r\n","export class VideoGallery {\r\n    constructor($element) {\r\n        this.$player = $element.find('[data-video-player]');\r\n        this.$videos = $element.find('[data-video-item]');\r\n        this.currentVideo = {};\r\n        this.bindEvents();\r\n    }\r\n\r\n    selectNewVideo(e) {\r\n        e.preventDefault();\r\n\r\n        const $target = $(e.currentTarget);\r\n\r\n        this.currentVideo = {\r\n            id: $target.data('videoId'),\r\n            $selectedThumb: $target,\r\n        };\r\n\r\n        this.setMainVideo();\r\n        this.setActiveThumb();\r\n    }\r\n\r\n    setMainVideo() {\r\n        this.$player.attr('src', `//www.youtube.com/embed/${this.currentVideo.id}`);\r\n    }\r\n\r\n    setActiveThumb() {\r\n        this.$videos.removeClass('is-active');\r\n        this.currentVideo.$selectedThumb.addClass('is-active');\r\n    }\r\n\r\n    bindEvents() {\r\n        this.$videos.on('click', this.selectNewVideo.bind(this));\r\n    }\r\n}\r\n\r\nexport default function videoGallery() {\r\n    const pluginKey = 'video-gallery';\r\n    const $videoGallery = $(`[data-${pluginKey}]`);\r\n\r\n    $videoGallery.each((index, element) => {\r\n        const $el = $(element);\r\n        const isInitialized = $el.data(pluginKey) instanceof VideoGallery;\r\n\r\n        if (isInitialized) {\r\n            return;\r\n        }\r\n\r\n        $el.data(pluginKey, new VideoGallery($el));\r\n    });\r\n}\r\n","/*\r\n Import all product specific js\r\n */\r\nimport PageManager from './page-manager';\r\nimport Review from './product/reviews';\r\nimport collapsibleFactory from './common/collapsible';\r\nimport ProductDetails from './common/product-details';\r\nimport videoGallery from './product/video-gallery';\r\nimport { classifyForm } from './common/form-utils';\r\n\r\nexport default class Product extends PageManager {\r\n    constructor(context) {\r\n        super(context);\r\n        this.url = window.location.href;\r\n        this.$reviewLink = $('[data-reveal-id=\"modal-review-form\"]');\r\n        this.$bulkPricingLink = $('[data-reveal-id=\"modal-bulk-pricing\"]');\r\n    }\r\n\r\n    onReady() {\r\n        // Listen for foundation modal close events to sanitize URL after review.\r\n        $(document).on('close.fndtn.reveal', () => {\r\n            if (this.url.indexOf('#write_review') !== -1 && typeof window.history.replaceState === 'function') {\r\n                window.history.replaceState(null, document.title, window.location.pathname);\r\n            }\r\n        });\r\n\r\n        let validator;\r\n\r\n        // Init collapsible\r\n        collapsibleFactory();\r\n\r\n        this.productDetails = new ProductDetails($('.productView'), this.context, window.BCData.product_attributes);\r\n        this.productDetails.setProductVariant();\r\n\r\n        videoGallery();\r\n\r\n        const $reviewForm = classifyForm('.writeReview-form');\r\n        const review = new Review($reviewForm);\r\n\r\n        $('body').on('click', '[data-reveal-id=\"modal-review-form\"]', () => {\r\n            validator = review.registerValidation(this.context);\r\n        });\r\n\r\n        $reviewForm.on('submit', () => {\r\n            if (validator) {\r\n                validator.performCheck();\r\n                return validator.areAll('valid');\r\n            }\r\n\r\n            return false;\r\n        });\r\n\r\n        this.productReviewHandler();\r\n        this.bulkPricingHandler();\r\n    }\r\n\r\n    productReviewHandler() {\r\n        if (this.url.indexOf('#write_review') !== -1) {\r\n            this.$reviewLink.trigger('click');\r\n        }\r\n    }\r\n\r\n    bulkPricingHandler() {\r\n        if (this.url.indexOf('#bulk_pricing') !== -1) {\r\n            this.$bulkPricingLink.trigger('click');\r\n        }\r\n    }\r\n}\n"],"sourceRoot":""}