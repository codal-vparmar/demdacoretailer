{"version":3,"sources":["webpack:///./assets/js/theme/catalog.js","webpack:///./assets/js/theme/common/faceted-search.js","webpack:///./assets/js/theme/brand.js","webpack:///./assets/js/theme/common/url-utils.js","webpack:///./assets/js/theme/global/compare-products.js"],"names":["CatalogPage","event","url","parse","window","location","href","queryParams","$","currentTarget","serialize","split","query","page","preventDefault","format","pathname","search","buildQueryString","requestOptions","callback","options","defaultOptions","accordionToggleSelector","blockerSelector","clearFacetSelector","componentSelector","facetNavListSelector","priceRangeErrorSelector","priceRangeFieldsetSelector","priceRangeFormSelector","priceRangeMaxPriceSelector","priceRangeMinPriceSelector","showMoreToggleSelector","facetedSearchFilterItems","modal","modalOpen","this","extend","collapsedFacets","collapsedFacetItems","initPriceValidator","each","index","navList","collapseFacetItems","accordionToggle","collapsible","data","isCollapsed","push","targetId","setTimeout","is","collapseAllFacets","onStateChange","bind","onToggleClick","onAccordionToggle","onClearFacet","onFacetClick","onRangeSubmit","onSortBySubmit","filterFacetItems","bindEvents","content","restoreCollapsedFacets","restoreCollapsedFacetItems","show","getPage","getUrl","err","hide","Error","refreshView","$navList","id","attr","without","hasMoreResults","union","includes","getMoreFacetResults","facet","facetUrl","showMore","template","params","list_all","response","open","updateContent","$items","val","toLowerCase","element","text","indexOf","$accordionToggle","close","collapseFacet","expandFacet","length","validator","selectors","errorSelector","fieldsetSelector","formSelector","maxPriceSelector","minPriceSelector","setMinMaxPriceValidation","priceRangeValidator","expandFacetItems","unbindEvents","on","document","off","stopPropagation","goToUrl","$toggle","toggleFacetItems","$link","toggleClass","areAll","constants","VALID","decodeURI","parseQueryParams","key","hasOwnProperty","updateView","Brand","context","urls","initFacetedSearch","$productListingContainer","$facetedSearchContainer","productListing","sidebar","config","shop_by_brand","brand","products","limit","brandProductsPerPage","facetedSearch","html","triggerHandler","animate","scrollTop","urlUtils","history","pushState","title","trigger","replaceParams","parsed","param","queryData","out","Array","isArray","ndx","substring","i","temp","updateCounterNav","counter","urlContext","addClass","compare","join","find","removeClass","compareCounter","$compareLink","$checked","map","value","product","$clickedCompareLink","item","checked","splice","decrementCounter"],"mappings":"2FAAA,mFAIe,MAAMA,UAAoB,IACrC,eAAeC,GACX,MAAMC,EAAM,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACtCC,EAAcC,EAAEP,EAAMQ,eAAeC,YAAYC,MAAM,KAE7DT,EAAIU,MAAML,EAAY,IAAMA,EAAY,UACjCL,EAAIU,MAAMC,KAEjBZ,EAAMa,iBACNV,OAAOC,SAAW,IAAIU,OAAO,CAAEC,SAAUd,EAAIc,SAAUC,OAAQ,IAASC,iBAAiBhB,EAAIU,a,mDCbrG,6FA4Ze,IAhZf,MAqBI,YAAYO,EAAgBC,EAAUC,GAClC,MAAMC,EAAiB,CACnBC,wBAAyB,6EACzBC,gBAAiB,0BACjBC,mBAAoB,0CACpBC,kBAAmB,yBACnBC,qBAAsB,0BACtBC,wBAAyB,wCACzBC,2BAA4B,mCAC5BC,uBAAwB,oBACxBC,2BAA4B,qCAC5BC,2BAA4B,qCAC5BC,uBAAwB,gDACxBC,yBAA0B,yCAC1BC,MAAO,YAAa,UAAU,GAC9BC,WAAW,GAIfC,KAAKlB,eAAiBA,EACtBkB,KAAKjB,SAAWA,EAChBiB,KAAKhB,QAAU,IAAEiB,OAAO,GAAIhB,EAAgBD,GAC5CgB,KAAKE,gBAAkB,GACvBF,KAAKG,oBAAsB,GAG3B,cAGAH,KAAKI,qBAGLjC,EAAE6B,KAAKhB,QAAQM,sBAAsBe,KAAK,CAACC,EAAOC,KAC9CP,KAAKQ,mBAAmBrC,EAAEoC,MAI9BpC,EAAE6B,KAAKhB,QAAQE,yBAAyBmB,KAAK,CAACC,EAAOG,KACjD,MACMC,EADmBvC,EAAEsC,GACUE,KAAK,uBAEtCD,EAAYE,aACZZ,KAAKE,gBAAgBW,KAAKH,EAAYI,YAM9CC,WAAW,KACH5C,EAAE6B,KAAKhB,QAAQK,mBAAmB2B,GAAG,YACrChB,KAAKiB,sBAKbjB,KAAKkB,cAAgBlB,KAAKkB,cAAcC,KAAKnB,MAC7CA,KAAKoB,cAAgBpB,KAAKoB,cAAcD,KAAKnB,MAC7CA,KAAKqB,kBAAoBrB,KAAKqB,kBAAkBF,KAAKnB,MACrDA,KAAKsB,aAAetB,KAAKsB,aAAaH,KAAKnB,MAC3CA,KAAKuB,aAAevB,KAAKuB,aAAaJ,KAAKnB,MAC3CA,KAAKwB,cAAgBxB,KAAKwB,cAAcL,KAAKnB,MAC7CA,KAAKyB,eAAiBzB,KAAKyB,eAAeN,KAAKnB,MAC/CA,KAAK0B,iBAAmB1B,KAAK0B,iBAAiBP,KAAKnB,MAEnDA,KAAK2B,aAIT,YAAYC,GACJA,GACA5B,KAAKjB,SAAS6C,GAIlB,cAGA5B,KAAKI,qBAGLJ,KAAK6B,yBACL7B,KAAK8B,6BAGL9B,KAAK2B,aAGT,aACIxD,EAAE6B,KAAKhB,QAAQG,iBAAiB4C,OAEhC,IAAIC,QAAQ,IAASC,SAAUjC,KAAKlB,eAAgB,CAACoD,EAAKN,KAGtD,GAFAzD,EAAE6B,KAAKhB,QAAQG,iBAAiBgD,OAE5BD,EACA,MAAM,IAAIE,MAAMF,GAIpBlC,KAAKqC,YAAYT,KAIzB,iBAAiBU,GACb,MAAMC,EAAKD,EAASE,KAAK,MAGzBxC,KAAKG,oBAAsB,IAAEsC,QAAQzC,KAAKG,oBAAqBoC,GAGnE,mBAAmBD,GACf,MAAMC,EAAKD,EAASE,KAAK,MACnBE,EAAiBJ,EAAS3B,KAAK,kBAGjCX,KAAKG,oBADLuC,EAC2B,IAAEC,MAAM3C,KAAKG,oBAAqB,CAACoC,IAEnC,IAAEE,QAAQzC,KAAKG,oBAAqBoC,GAIvE,iBAAiBD,GACb,MAAMC,EAAKD,EAASE,KAAK,MAGzB,OAAI,IAAEI,SAAS5C,KAAKG,oBAAqBoC,IACrCvC,KAAK6C,oBAAoBP,IAElB,IAGXtC,KAAKQ,mBAAmB8B,IAEjB,GAGX,oBAAoBA,GAChB,MAAMQ,EAAQR,EAAS3B,KAAK,SACtBoC,EAAW,IAASd,SAqB1B,OAnBIjC,KAAKlB,eAAekE,UACpB,IAAIhB,QAAQe,EAAU,CAClBE,SAAUjD,KAAKlB,eAAekE,SAC9BE,OAAQ,CACJC,SAAUL,IAEf,CAACZ,EAAKkB,KACL,GAAIlB,EACA,MAAM,IAAIE,MAAMF,GAGpBlC,KAAKhB,QAAQc,MAAMuD,OACnBrD,KAAKhB,QAAQe,WAAY,EACzBC,KAAKhB,QAAQc,MAAMwD,cAAcF,KAIzCpD,KAAKQ,mBAAmB8B,IAEjB,EAGX,iBAAiB1E,GACb,MAAM2F,EAASpF,EAAE,iBACXI,EAAQJ,EAAEP,EAAMQ,eAAeoF,MAAMC,cAE3CF,EAAOlD,KAAK,CAACC,EAAOoD,MAEa,IADhBvF,EAAEuF,GAASC,OAAOF,cACtBG,QAAQrF,GACbJ,EAAEuF,GAAS3B,OAEX5D,EAAEuF,GAASvB,SAKvB,YAAY0B,GACYA,EAAiBlD,KAAK,uBAE9B0C,OAGhB,cAAcQ,GACUA,EAAiBlD,KAAK,uBAE9BmD,QAGhB,oBAC8B3F,EAAE6B,KAAKhB,QAAQE,yBAEvBmB,KAAK,CAACC,EAAOG,KAC3B,MAAMoD,EAAmB1F,EAAEsC,GAE3BT,KAAK+D,cAAcF,KAI3B,kBAC8B1F,EAAE6B,KAAKhB,QAAQE,yBAEvBmB,KAAK,CAACC,EAAOG,KAC3B,MAAMoD,EAAmB1F,EAAEsC,GAE3BT,KAAKgE,YAAYH,KAKzB,qBACI,GAAsD,IAAlD1F,EAAE6B,KAAKhB,QAAQS,wBAAwBwE,OACvC,OAGJ,MAAMC,EAAY,cACZC,EAAY,CACdC,cAAepE,KAAKhB,QAAQO,wBAC5B8E,iBAAkBrE,KAAKhB,QAAQQ,2BAC/B8E,aAActE,KAAKhB,QAAQS,uBAC3B8E,iBAAkBvE,KAAKhB,QAAQU,2BAC/B8E,iBAAkBxE,KAAKhB,QAAQW,4BAGnC,IAAW8E,yBAAyBP,EAAWC,GAE/CnE,KAAK0E,oBAAsBR,EAG/B,6BACsB/F,EAAE6B,KAAKhB,QAAQM,sBAGvBe,KAAK,CAACC,EAAOC,KACnB,MAAM+B,EAAWnE,EAAEoC,GACbgC,EAAKD,EAASE,KAAK,MACF,IAAEI,SAAS5C,KAAKG,oBAAqBoC,GAGxDvC,KAAKQ,mBAAmB8B,GAExBtC,KAAK2E,iBAAiBrC,KAKlC,yBAC8BnE,EAAE6B,KAAKhB,QAAQE,yBAEvBmB,KAAK,CAACC,EAAOG,KAC3B,MAAMoD,EAAmB1F,EAAEsC,GAErB8B,EADcsB,EAAiBlD,KAAK,uBACnBG,SACA,IAAE8B,SAAS5C,KAAKE,gBAAiBqC,GAGpDvC,KAAK+D,cAAcF,GAEnB7D,KAAKgE,YAAYH,KAK7B,aAEI7D,KAAK4E,eAGLzG,EAAEJ,QAAQ8G,GAAG,cAAe7E,KAAKkB,eACjC/C,EAAE2G,UAAUD,GAAG,QAAS7E,KAAKhB,QAAQY,uBAAwBI,KAAKoB,eAClEjD,EAAE2G,UAAUD,GAAG,qBAAsB7E,KAAKhB,QAAQE,wBAAyBc,KAAKqB,mBAChFlD,EAAE2G,UAAUD,GAAG,QAAS7E,KAAKhB,QAAQa,yBAA0BG,KAAK0B,kBACpEvD,EAAE6B,KAAKhB,QAAQI,oBAAoByF,GAAG,QAAS7E,KAAKsB,cAGpD,IAAMuD,GAAG,8BAA+B7E,KAAKuB,cAC7C,IAAMsD,GAAG,gCAAiC7E,KAAKwB,eAC/C,IAAMqD,GAAG,mBAAoB7E,KAAKyB,gBAGtC,eAEItD,EAAEJ,QAAQgH,IAAI,cAAe/E,KAAKkB,eAClC/C,EAAE2G,UAAUC,IAAI,QAAS/E,KAAKhB,QAAQY,uBAAwBI,KAAKoB,eACnEjD,EAAE2G,UAAUC,IAAI,qBAAsB/E,KAAKhB,QAAQE,wBAAyBc,KAAKqB,mBACjFlD,EAAE2G,UAAUC,IAAI,QAAS/E,KAAKhB,QAAQa,yBAA0BG,KAAK0B,kBACrEvD,EAAE6B,KAAKhB,QAAQI,oBAAoB2F,IAAI,QAAS/E,KAAKsB,cAGrD,IAAMyD,IAAI,8BAA+B/E,KAAKuB,cAC9C,IAAMwD,IAAI,gCAAiC/E,KAAKwB,eAChD,IAAMuD,IAAI,mBAAoB/E,KAAKyB,gBAGvC,aAAa7D,GACT,MACMC,EADQM,EAAEP,EAAMQ,eACJoE,KAAK,QAEvB5E,EAAMa,iBACNb,EAAMoH,kBAGN,IAASC,QAAQpH,GAGrB,cAAcD,GACV,MAAMsH,EAAU/G,EAAEP,EAAMQ,eAClBkE,EAAWnE,EAAE+G,EAAQ1C,KAAK,SAGhC5E,EAAMa,iBAGNuB,KAAKmF,iBAAiB7C,GAG1B,aAAa1E,GACT,MAAMwH,EAAQjH,EAAEP,EAAMQ,eAChBP,EAAMuH,EAAM5C,KAAK,QAEvB5E,EAAMa,iBAEN2G,EAAMC,YAAY,eAGlB,IAASJ,QAAQpH,GAEbmC,KAAKhB,QAAQe,WACbC,KAAKhB,QAAQc,MAAMgE,QAI3B,eAAelG,GACX,MAAMC,EAAM,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GACtCC,EAAcC,EAAEP,EAAMQ,eAAeC,YAAYC,MAAM,KAE7DT,EAAIU,MAAML,EAAY,IAAMA,EAAY,UACjCL,EAAIU,MAAMC,KAEjBZ,EAAMa,iBAEN,IAASwG,QAAQ,IAAIvG,OAAO,CAAEC,SAAUd,EAAIc,SAAUC,OAAQ,IAASC,iBAAiBhB,EAAIU,UAGhG,cAAcX,GAGV,GAFAA,EAAMa,kBAEDuB,KAAK0E,oBAAoBY,OAAO,IAAIC,UAAUC,OAC/C,OAGJ,MAAM3H,EAAM,IAAIC,MAAMC,OAAOC,SAASC,MAAM,GAC5C,IAAIC,EAAcuH,UAAUtH,EAAEP,EAAMQ,eAAeC,aAAaC,MAAM,KACtEJ,EAAc,IAASwH,iBAAiBxH,GAExC,IAAK,MAAMyH,KAAOzH,EACVA,EAAY0H,eAAeD,KAC3B9H,EAAIU,MAAMoH,GAAOzH,EAAYyH,IAIrC,IAASV,QAAQ,IAAIvG,OAAO,CAAEC,SAAUd,EAAIc,SAAUC,OAAQ,IAASC,iBAAiBhB,EAAIU,UAGhG,gBACIyB,KAAK6F,aAGT,kBAAkBjI,GACd,MACM8C,EADmBvC,EAAEP,EAAMQ,eACIuC,KAAK,uBACpC4B,EAAK7B,EAAYI,SAEnBJ,EAAYE,YACZZ,KAAKE,gBAAkB,IAAEyC,MAAM3C,KAAKE,gBAAiB,CAACqC,IAEtDvC,KAAKE,gBAAkB,IAAEuC,QAAQzC,KAAKE,gBAAiBqC,O,iDCvZnE,gGAKe,MAAMuD,UAAc,IAC/B,UACI,YAAgB9F,KAAK+F,QAAQC,MAEzB7H,EAAE,kBAAkB8F,OAAS,EAC7BjE,KAAKiG,qBAELjG,KAAKyB,eAAiBzB,KAAKyB,eAAeN,KAAKnB,MAC/C,IAAM6E,GAAG,mBAAoB7E,KAAKyB,iBAI1C,oBACI,MAAMyE,EAA2B/H,EAAE,8BAC7BgI,EAA0BhI,EAAE,6BAE5BW,EAAiB,CACnBmE,SAAU,CACNmD,eAAgB,wBAChBC,QAAS,iBAEbC,OAAQ,CACJC,eAAe,EACfC,MAAO,CACHC,SAAU,CACNC,MAVQ1G,KAAK+F,QAAQY,wBAcjC3D,SAAU,mBAGdhD,KAAK4G,cAAgB,IAAI,IAAc9H,EAAiB8C,IACpDsE,EAAyBW,KAAKjF,EAAQwE,gBACtCD,EAAwBU,KAAKjF,EAAQyE,SAErClI,EAAE,QAAQ2I,eAAe,gBAEzB3I,EAAE,cAAc4I,QAAQ,CACpBC,UAAW,GACZ,U,kDC7Cf,iCAEA,MAAMC,EAAW,CACbhF,OAAQ,IAAM,GAAGlE,OAAOC,SAASW,WAAWZ,OAAOC,SAASY,SAE5DqG,QAAUpH,IACNE,OAAOmJ,QAAQC,UAAU,GAAIrC,SAASsC,MAAOvJ,GAC7CM,EAAEJ,QAAQsJ,QAAQ,gBAGtBC,cAAe,CAACzJ,EAAKqF,KACjB,MAAMqE,EAAS,IAAIzJ,MAAMD,GAAK,GAC9B,IAAI2J,EAKJ,IAAKA,KAFLD,EAAO3I,OAAS,KAEFsE,EACNA,EAAO0C,eAAe4B,KACtBD,EAAOhJ,MAAMiJ,GAAStE,EAAOsE,IAIrC,OAAO,IAAI9I,OAAO6I,IAGtB1I,iBAAmB4I,IACf,IACI9B,EADA+B,EAAM,GAEV,IAAK/B,KAAO8B,EACR,GAAIA,EAAU7B,eAAeD,GACzB,GAAIgC,MAAMC,QAAQH,EAAU9B,IAAO,CAC/B,IAAIkC,EAEJ,IAAKA,KAAOJ,EAAU9B,GACd8B,EAAU9B,GAAKC,eAAeiC,KAC9BH,GAAO,IAAI/B,KAAO8B,EAAU9B,GAAKkC,WAIzCH,GAAO,IAAI/B,KAAO8B,EAAU9B,KAKxC,OAAO+B,EAAII,UAAU,IAGzBpC,iBAAmB+B,IACf,MAAMvE,EAAS,GAEf,IAAK,IAAI6E,EAAI,EAAGA,EAAIN,EAAUxD,OAAQ8D,IAAK,CACvC,MAAMC,EAAOP,EAAUM,GAAGzJ,MAAM,KAE5B0J,EAAK,KAAM9E,EACPyE,MAAMC,QAAQ1E,EAAO8E,EAAK,KAC1B9E,EAAO8E,EAAK,IAAInH,KAAKmH,EAAK,IAE1B9E,EAAO8E,EAAK,IAAM,CAAC9E,EAAO8E,EAAK,IAAKA,EAAK,IAG7C9E,EAAO8E,EAAK,IAAMA,EAAK,GAI/B,OAAO9E,IAIA,Q,kDCrEf,uCAeA,SAAS+E,EAAiBC,EAAS9C,EAAO+C,GACf,IAAnBD,EAAQjE,QACHmB,EAAMpE,GAAG,YACVoE,EAAMgD,SAAS,QAEnBhD,EAAM5C,KAAK,OAAQ,GAAG2F,EAAWE,WAAWH,EAAQI,KAAK,QACzDlD,EAAMmD,KAAK,kBAAkB1B,KAAKqB,EAAQjE,SAE1CmB,EAAMoD,YAAY,QAIX,gBACX,IAAIC,EAAiB,GAErB,MAAMC,EAAevK,EAAE,uBAEvBA,EAAE,QAAQ0G,GAAG,eAAgB,KACzB,MAAM8D,EAAWxK,EAAE,QAAQoK,KAAK,oCAEhCE,EAAiBE,EAAS1E,OAAS,IAAE2E,IAAID,EAAUjF,GAAWA,EAAQmF,OAAS,GAC/EZ,EAAiBQ,EAAgBC,EAAcP,KAGnDhK,EAAE,QAAQ2I,eAAe,gBAEzB3I,EAAE,QAAQ0G,GAAG,QAAS,oBAAqBjH,IACvC,MAAMkL,EAAUlL,EAAMQ,cAAcyK,MAC9BE,EAAsB5K,EAAE,uBAhCtC,IAAmC6K,EAkCvBpL,EAAMQ,cAAc6K,SAlCGD,EAmCUF,EAAhBL,EAlCjB5H,KAAKmI,IATjB,SAA0Bd,EAASc,GAC/B,MAAM1I,EAAQ4H,EAAQtE,QAAQoF,GAE1B1I,GAAS,GACT4H,EAAQgB,OAAO5I,EAAO,GAyClB6I,CAAiBV,EAAgBK,GAGrCb,EAAiBQ,EAAgBM,EAAqBZ,KAG1DhK,EAAE,QAAQ0G,GAAG,SAAU,yBAA0BjH,IAC/BO,EAAEP,EAAMQ,eACUmK,KAAK,oCAEftE,QAAU,IAC5B,YAAe,oDACfrG,EAAMa,oBAIdN,EAAE,QAAQ0G,GAAG,QAAS,sBAAuB,KAGzC,GAF6B1G,EAAE,QAAQoK,KAAK,oCAEnBtE,QAAU,EAE/B,OADA,YAAe,qDACR,O","file":"theme-bundle.chunk.9.js","sourcesContent":["import PageManager from './page-manager';\r\nimport urlUtils from './common/url-utils';\r\nimport Url from 'url';\r\n\r\nexport default class CatalogPage extends PageManager {\r\n    onSortBySubmit(event) {\r\n        const url = Url.parse(window.location.href, true);\r\n        const queryParams = $(event.currentTarget).serialize().split('=');\r\n\r\n        url.query[queryParams[0]] = queryParams[1];\r\n        delete url.query.page;\r\n\r\n        event.preventDefault();\r\n        window.location = Url.format({ pathname: url.pathname, search: urlUtils.buildQueryString(url.query) });\r\n    }\r\n}\r\n","import { hooks, api } from '@bigcommerce/stencil-utils';\r\nimport _ from 'lodash';\r\nimport Url from 'url';\r\nimport urlUtils from './url-utils';\r\nimport modalFactory from '../global/modal';\r\nimport collapsibleFactory from './collapsible';\r\nimport { Validators } from './form-utils';\r\nimport nod from './nod';\r\n\r\n/**\r\n * Faceted search view component\r\n */\r\nclass FacetedSearch {\r\n    /**\r\n     * @param {object} requestOptions - Object with options for the ajax requests\r\n     * @param {function} callback - Function to execute after fetching templates\r\n     * @param {object} options - Configurable options\r\n     * @example\r\n     *\r\n     * let requestOptions = {\r\n     *      templates: {\r\n     *          productListing: 'category/product-listing',\r\n     *          sidebar: 'category/sidebar'\r\n     *     }\r\n     * };\r\n     *\r\n     * let templatesDidLoad = function(content) {\r\n     *     $productListingContainer.html(content.productListing);\r\n     *     $facetedSearchContainer.html(content.sidebar);\r\n     * };\r\n     *\r\n     * let facetedSearch = new FacetedSearch(requestOptions, templatesDidLoad);\r\n     */\r\n    constructor(requestOptions, callback, options) {\r\n        const defaultOptions = {\r\n            accordionToggleSelector: '#facetedSearch .accordion-navigation, #facetedSearch .facetedSearch-toggle',\r\n            blockerSelector: '#facetedSearch .blocker',\r\n            clearFacetSelector: '#facetedSearch .facetedSearch-clearLink',\r\n            componentSelector: '#facetedSearch-navList',\r\n            facetNavListSelector: '#facetedSearch .navList',\r\n            priceRangeErrorSelector: '#facet-range-form .form-inlineMessage',\r\n            priceRangeFieldsetSelector: '#facet-range-form .form-fieldset',\r\n            priceRangeFormSelector: '#facet-range-form',\r\n            priceRangeMaxPriceSelector: '#facet-range-form [name=max_price]',\r\n            priceRangeMinPriceSelector: '#facet-range-form [name=min_price]',\r\n            showMoreToggleSelector: '#facetedSearch .accordion-content .toggleLink',\r\n            facetedSearchFilterItems: '#facetedSearch-filterItems .form-input',\r\n            modal: modalFactory('#modal')[0],\r\n            modalOpen: false,\r\n        };\r\n\r\n        // Private properties\r\n        this.requestOptions = requestOptions;\r\n        this.callback = callback;\r\n        this.options = _.extend({}, defaultOptions, options);\r\n        this.collapsedFacets = [];\r\n        this.collapsedFacetItems = [];\r\n\r\n        // Init collapsibles\r\n        collapsibleFactory();\r\n\r\n        // Init price validator\r\n        this.initPriceValidator();\r\n\r\n        // Show limited items by default\r\n        $(this.options.facetNavListSelector).each((index, navList) => {\r\n            this.collapseFacetItems($(navList));\r\n        });\r\n\r\n        // Mark initially collapsed accordions\r\n        $(this.options.accordionToggleSelector).each((index, accordionToggle) => {\r\n            const $accordionToggle = $(accordionToggle);\r\n            const collapsible = $accordionToggle.data('collapsibleInstance');\r\n\r\n            if (collapsible.isCollapsed) {\r\n                this.collapsedFacets.push(collapsible.targetId);\r\n            }\r\n        });\r\n\r\n        // Collapse all facets if initially hidden\r\n        // NOTE: Need to execute after Collapsible gets bootstrapped\r\n        setTimeout(() => {\r\n            if ($(this.options.componentSelector).is(':hidden')) {\r\n                this.collapseAllFacets();\r\n            }\r\n        });\r\n\r\n        // Observe user events\r\n        this.onStateChange = this.onStateChange.bind(this);\r\n        this.onToggleClick = this.onToggleClick.bind(this);\r\n        this.onAccordionToggle = this.onAccordionToggle.bind(this);\r\n        this.onClearFacet = this.onClearFacet.bind(this);\r\n        this.onFacetClick = this.onFacetClick.bind(this);\r\n        this.onRangeSubmit = this.onRangeSubmit.bind(this);\r\n        this.onSortBySubmit = this.onSortBySubmit.bind(this);\r\n        this.filterFacetItems = this.filterFacetItems.bind(this);\r\n\r\n        this.bindEvents();\r\n    }\r\n\r\n    // Public methods\r\n    refreshView(content) {\r\n        if (content) {\r\n            this.callback(content);\r\n        }\r\n\r\n        // Init collapsibles\r\n        collapsibleFactory();\r\n\r\n        // Init price validator\r\n        this.initPriceValidator();\r\n\r\n        // Restore view state\r\n        this.restoreCollapsedFacets();\r\n        this.restoreCollapsedFacetItems();\r\n\r\n        // Bind events\r\n        this.bindEvents();\r\n    }\r\n\r\n    updateView() {\r\n        $(this.options.blockerSelector).show();\r\n\r\n        api.getPage(urlUtils.getUrl(), this.requestOptions, (err, content) => {\r\n            $(this.options.blockerSelector).hide();\r\n\r\n            if (err) {\r\n                throw new Error(err);\r\n            }\r\n\r\n            // Refresh view with new content\r\n            this.refreshView(content);\r\n        });\r\n    }\r\n\r\n    expandFacetItems($navList) {\r\n        const id = $navList.attr('id');\r\n\r\n        // Remove\r\n        this.collapsedFacetItems = _.without(this.collapsedFacetItems, id);\r\n    }\r\n\r\n    collapseFacetItems($navList) {\r\n        const id = $navList.attr('id');\r\n        const hasMoreResults = $navList.data('hasMoreResults');\r\n\r\n        if (hasMoreResults) {\r\n            this.collapsedFacetItems = _.union(this.collapsedFacetItems, [id]);\r\n        } else {\r\n            this.collapsedFacetItems = _.without(this.collapsedFacetItems, id);\r\n        }\r\n    }\r\n\r\n    toggleFacetItems($navList) {\r\n        const id = $navList.attr('id');\r\n\r\n        // Toggle depending on `collapsed` flag\r\n        if (_.includes(this.collapsedFacetItems, id)) {\r\n            this.getMoreFacetResults($navList);\r\n\r\n            return true;\r\n        }\r\n\r\n        this.collapseFacetItems($navList);\r\n\r\n        return false;\r\n    }\r\n\r\n    getMoreFacetResults($navList) {\r\n        const facet = $navList.data('facet');\r\n        const facetUrl = urlUtils.getUrl();\r\n\r\n        if (this.requestOptions.showMore) {\r\n            api.getPage(facetUrl, {\r\n                template: this.requestOptions.showMore,\r\n                params: {\r\n                    list_all: facet,\r\n                },\r\n            }, (err, response) => {\r\n                if (err) {\r\n                    throw new Error(err);\r\n                }\r\n\r\n                this.options.modal.open();\r\n                this.options.modalOpen = true;\r\n                this.options.modal.updateContent(response);\r\n            });\r\n        }\r\n\r\n        this.collapseFacetItems($navList);\r\n\r\n        return false;\r\n    }\r\n\r\n    filterFacetItems(event) {\r\n        const $items = $('.navList-item');\r\n        const query = $(event.currentTarget).val().toLowerCase();\r\n\r\n        $items.each((index, element) => {\r\n            const text = $(element).text().toLowerCase();\r\n            if (text.indexOf(query) !== -1) {\r\n                $(element).show();\r\n            } else {\r\n                $(element).hide();\r\n            }\r\n        });\r\n    }\r\n\r\n    expandFacet($accordionToggle) {\r\n        const collapsible = $accordionToggle.data('collapsibleInstance');\r\n\r\n        collapsible.open();\r\n    }\r\n\r\n    collapseFacet($accordionToggle) {\r\n        const collapsible = $accordionToggle.data('collapsibleInstance');\r\n\r\n        collapsible.close();\r\n    }\r\n\r\n    collapseAllFacets() {\r\n        const $accordionToggles = $(this.options.accordionToggleSelector);\r\n\r\n        $accordionToggles.each((index, accordionToggle) => {\r\n            const $accordionToggle = $(accordionToggle);\r\n\r\n            this.collapseFacet($accordionToggle);\r\n        });\r\n    }\r\n\r\n    expandAllFacets() {\r\n        const $accordionToggles = $(this.options.accordionToggleSelector);\r\n\r\n        $accordionToggles.each((index, accordionToggle) => {\r\n            const $accordionToggle = $(accordionToggle);\r\n\r\n            this.expandFacet($accordionToggle);\r\n        });\r\n    }\r\n\r\n    // Private methods\r\n    initPriceValidator() {\r\n        if ($(this.options.priceRangeFormSelector).length === 0) {\r\n            return;\r\n        }\r\n\r\n        const validator = nod();\r\n        const selectors = {\r\n            errorSelector: this.options.priceRangeErrorSelector,\r\n            fieldsetSelector: this.options.priceRangeFieldsetSelector,\r\n            formSelector: this.options.priceRangeFormSelector,\r\n            maxPriceSelector: this.options.priceRangeMaxPriceSelector,\r\n            minPriceSelector: this.options.priceRangeMinPriceSelector,\r\n        };\r\n\r\n        Validators.setMinMaxPriceValidation(validator, selectors);\r\n\r\n        this.priceRangeValidator = validator;\r\n    }\r\n\r\n    restoreCollapsedFacetItems() {\r\n        const $navLists = $(this.options.facetNavListSelector);\r\n\r\n        // Restore collapsed state for each facet\r\n        $navLists.each((index, navList) => {\r\n            const $navList = $(navList);\r\n            const id = $navList.attr('id');\r\n            const shouldCollapse = _.includes(this.collapsedFacetItems, id);\r\n\r\n            if (shouldCollapse) {\r\n                this.collapseFacetItems($navList);\r\n            } else {\r\n                this.expandFacetItems($navList);\r\n            }\r\n        });\r\n    }\r\n\r\n    restoreCollapsedFacets() {\r\n        const $accordionToggles = $(this.options.accordionToggleSelector);\r\n\r\n        $accordionToggles.each((index, accordionToggle) => {\r\n            const $accordionToggle = $(accordionToggle);\r\n            const collapsible = $accordionToggle.data('collapsibleInstance');\r\n            const id = collapsible.targetId;\r\n            const shouldCollapse = _.includes(this.collapsedFacets, id);\r\n\r\n            if (shouldCollapse) {\r\n                this.collapseFacet($accordionToggle);\r\n            } else {\r\n                this.expandFacet($accordionToggle);\r\n            }\r\n        });\r\n    }\r\n\r\n    bindEvents() {\r\n        // Clean-up\r\n        this.unbindEvents();\r\n\r\n        // DOM events\r\n        $(window).on('statechange', this.onStateChange);\r\n        $(document).on('click', this.options.showMoreToggleSelector, this.onToggleClick);\r\n        $(document).on('toggle.collapsible', this.options.accordionToggleSelector, this.onAccordionToggle);\r\n        $(document).on('keyup', this.options.facetedSearchFilterItems, this.filterFacetItems);\r\n        $(this.options.clearFacetSelector).on('click', this.onClearFacet);\r\n\r\n        // Hooks\r\n        hooks.on('facetedSearch-facet-clicked', this.onFacetClick);\r\n        hooks.on('facetedSearch-range-submitted', this.onRangeSubmit);\r\n        hooks.on('sortBy-submitted', this.onSortBySubmit);\r\n    }\r\n\r\n    unbindEvents() {\r\n        // DOM events\r\n        $(window).off('statechange', this.onStateChange);\r\n        $(document).off('click', this.options.showMoreToggleSelector, this.onToggleClick);\r\n        $(document).off('toggle.collapsible', this.options.accordionToggleSelector, this.onAccordionToggle);\r\n        $(document).off('keyup', this.options.facetedSearchFilterItems, this.filterFacetItems);\r\n        $(this.options.clearFacetSelector).off('click', this.onClearFacet);\r\n\r\n        // Hooks\r\n        hooks.off('facetedSearch-facet-clicked', this.onFacetClick);\r\n        hooks.off('facetedSearch-range-submitted', this.onRangeSubmit);\r\n        hooks.off('sortBy-submitted', this.onSortBySubmit);\r\n    }\r\n\r\n    onClearFacet(event) {\r\n        const $link = $(event.currentTarget);\r\n        const url = $link.attr('href');\r\n\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        // Update URL\r\n        urlUtils.goToUrl(url);\r\n    }\r\n\r\n    onToggleClick(event) {\r\n        const $toggle = $(event.currentTarget);\r\n        const $navList = $($toggle.attr('href'));\r\n\r\n        // Prevent default\r\n        event.preventDefault();\r\n\r\n        // Toggle visible items\r\n        this.toggleFacetItems($navList);\r\n    }\r\n\r\n    onFacetClick(event) {\r\n        const $link = $(event.currentTarget);\r\n        const url = $link.attr('href');\r\n\r\n        event.preventDefault();\r\n\r\n        $link.toggleClass('is-selected');\r\n\r\n        // Update URL\r\n        urlUtils.goToUrl(url);\r\n\r\n        if (this.options.modalOpen) {\r\n            this.options.modal.close();\r\n        }\r\n    }\r\n\r\n    onSortBySubmit(event) {\r\n        const url = Url.parse(window.location.href, true);\r\n        const queryParams = $(event.currentTarget).serialize().split('=');\r\n\r\n        url.query[queryParams[0]] = queryParams[1];\r\n        delete url.query.page;\r\n\r\n        event.preventDefault();\r\n\r\n        urlUtils.goToUrl(Url.format({ pathname: url.pathname, search: urlUtils.buildQueryString(url.query) }));\r\n    }\r\n\r\n    onRangeSubmit(event) {\r\n        event.preventDefault();\r\n\r\n        if (!this.priceRangeValidator.areAll(nod.constants.VALID)) {\r\n            return;\r\n        }\r\n\r\n        const url = Url.parse(window.location.href, true);\r\n        let queryParams = decodeURI($(event.currentTarget).serialize()).split('&');\r\n        queryParams = urlUtils.parseQueryParams(queryParams);\r\n\r\n        for (const key in queryParams) {\r\n            if (queryParams.hasOwnProperty(key)) {\r\n                url.query[key] = queryParams[key];\r\n            }\r\n        }\r\n\r\n        urlUtils.goToUrl(Url.format({ pathname: url.pathname, search: urlUtils.buildQueryString(url.query) }));\r\n    }\r\n\r\n    onStateChange() {\r\n        this.updateView();\r\n    }\r\n\r\n    onAccordionToggle(event) {\r\n        const $accordionToggle = $(event.currentTarget);\r\n        const collapsible = $accordionToggle.data('collapsibleInstance');\r\n        const id = collapsible.targetId;\r\n\r\n        if (collapsible.isCollapsed) {\r\n            this.collapsedFacets = _.union(this.collapsedFacets, [id]);\r\n        } else {\r\n            this.collapsedFacets = _.without(this.collapsedFacets, id);\r\n        }\r\n    }\r\n}\r\n\r\nexport default FacetedSearch;\r\n","import { hooks } from '@bigcommerce/stencil-utils';\r\nimport CatalogPage from './catalog';\r\nimport compareProducts from './global/compare-products';\r\nimport FacetedSearch from './common/faceted-search';\r\n\r\nexport default class Brand extends CatalogPage {\r\n    onReady() {\r\n        compareProducts(this.context.urls);\r\n\r\n        if ($('#facetedSearch').length > 0) {\r\n            this.initFacetedSearch();\r\n        } else {\r\n            this.onSortBySubmit = this.onSortBySubmit.bind(this);\r\n            hooks.on('sortBy-submitted', this.onSortBySubmit);\r\n        }\r\n    }\r\n\r\n    initFacetedSearch() {\r\n        const $productListingContainer = $('#product-listing-container');\r\n        const $facetedSearchContainer = $('#faceted-search-container');\r\n        const productsPerPage = this.context.brandProductsPerPage;\r\n        const requestOptions = {\r\n            template: {\r\n                productListing: 'brand/product-listing',\r\n                sidebar: 'brand/sidebar',\r\n            },\r\n            config: {\r\n                shop_by_brand: true,\r\n                brand: {\r\n                    products: {\r\n                        limit: productsPerPage,\r\n                    },\r\n                },\r\n            },\r\n            showMore: 'brand/show-more',\r\n        };\r\n\r\n        this.facetedSearch = new FacetedSearch(requestOptions, (content) => {\r\n            $productListingContainer.html(content.productListing);\r\n            $facetedSearchContainer.html(content.sidebar);\r\n\r\n            $('body').triggerHandler('compareReset');\r\n\r\n            $('html, body').animate({\r\n                scrollTop: 0,\r\n            }, 100);\r\n        });\r\n    }\r\n}\r\n","import Url from 'url';\r\n\r\nconst urlUtils = {\r\n    getUrl: () => `${window.location.pathname}${window.location.search}`,\r\n\r\n    goToUrl: (url) => {\r\n        window.history.pushState({}, document.title, url);\r\n        $(window).trigger('statechange');\r\n    },\r\n\r\n    replaceParams: (url, params) => {\r\n        const parsed = Url.parse(url, true);\r\n        let param;\r\n\r\n        // Let the formatter use the query object to build the new url\r\n        parsed.search = null;\r\n\r\n        for (param in params) {\r\n            if (params.hasOwnProperty(param)) {\r\n                parsed.query[param] = params[param];\r\n            }\r\n        }\r\n\r\n        return Url.format(parsed);\r\n    },\r\n\r\n    buildQueryString: (queryData) => {\r\n        let out = '';\r\n        let key;\r\n        for (key in queryData) {\r\n            if (queryData.hasOwnProperty(key)) {\r\n                if (Array.isArray(queryData[key])) {\r\n                    let ndx;\r\n\r\n                    for (ndx in queryData[key]) {\r\n                        if (queryData[key].hasOwnProperty(ndx)) {\r\n                            out += `&${key}=${queryData[key][ndx]}`;\r\n                        }\r\n                    }\r\n                } else {\r\n                    out += `&${key}=${queryData[key]}`;\r\n                }\r\n            }\r\n        }\r\n\r\n        return out.substring(1);\r\n    },\r\n\r\n    parseQueryParams: (queryData) => {\r\n        const params = {};\r\n\r\n        for (let i = 0; i < queryData.length; i++) {\r\n            const temp = queryData[i].split('=');\r\n\r\n            if (temp[0] in params) {\r\n                if (Array.isArray(params[temp[0]])) {\r\n                    params[temp[0]].push(temp[1]);\r\n                } else {\r\n                    params[temp[0]] = [params[temp[0]], temp[1]];\r\n                }\r\n            } else {\r\n                params[temp[0]] = temp[1];\r\n            }\r\n        }\r\n\r\n        return params;\r\n    },\r\n};\r\n\r\nexport default urlUtils;\r\n","import _ from 'lodash';\r\nimport { showAlertModal } from './modal';\r\n\r\nfunction decrementCounter(counter, item) {\r\n    const index = counter.indexOf(item);\r\n\r\n    if (index > -1) {\r\n        counter.splice(index, 1);\r\n    }\r\n}\r\n\r\nfunction incrementCounter(counter, item) {\r\n    counter.push(item);\r\n}\r\n\r\nfunction updateCounterNav(counter, $link, urlContext) {\r\n    if (counter.length !== 0) {\r\n        if (!$link.is('visible')) {\r\n            $link.addClass('show');\r\n        }\r\n        $link.attr('href', `${urlContext.compare}/${counter.join('/')}`);\r\n        $link.find('span.countPill').html(counter.length);\r\n    } else {\r\n        $link.removeClass('show');\r\n    }\r\n}\r\n\r\nexport default function (urlContext) {\r\n    let compareCounter = [];\r\n\r\n    const $compareLink = $('a[data-compare-nav]');\r\n\r\n    $('body').on('compareReset', () => {\r\n        const $checked = $('body').find('input[name=\"products\\[\\]\"]:checked');\r\n\r\n        compareCounter = $checked.length ? _.map($checked, element => element.value) : [];\r\n        updateCounterNav(compareCounter, $compareLink, urlContext);\r\n    });\r\n\r\n    $('body').triggerHandler('compareReset');\r\n\r\n    $('body').on('click', '[data-compare-id]', event => {\r\n        const product = event.currentTarget.value;\r\n        const $clickedCompareLink = $('a[data-compare-nav]');\r\n\r\n        if (event.currentTarget.checked) {\r\n            incrementCounter(compareCounter, product);\r\n        } else {\r\n            decrementCounter(compareCounter, product);\r\n        }\r\n\r\n        updateCounterNav(compareCounter, $clickedCompareLink, urlContext);\r\n    });\r\n\r\n    $('body').on('submit', '[data-product-compare]', event => {\r\n        const $this = $(event.currentTarget);\r\n        const productsToCompare = $this.find('input[name=\"products\\[\\]\"]:checked');\r\n\r\n        if (productsToCompare.length <= 1) {\r\n            showAlertModal('You must select at least two products to compare');\r\n            event.preventDefault();\r\n        }\r\n    });\r\n\r\n    $('body').on('click', 'a[data-compare-nav]', () => {\r\n        const $clickedCheckedInput = $('body').find('input[name=\"products\\[\\]\"]:checked');\r\n\r\n        if ($clickedCheckedInput.length <= 1) {\r\n            showAlertModal('You must select at least two products to compare');\r\n            return false;\r\n        }\r\n    });\r\n}\r\n"],"sourceRoot":""}